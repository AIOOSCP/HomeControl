meta:
  name: RGB Light
  description: Enables RGB light over a pigpio adapter

items:
  RGBLight:
    config_fields:
      pin_r:
        type: Integer
        default: 22
      pin_g:
        type: Integer
        default: 27
      pin_b:
        type: Integer
        default: 17
      pigpio_adapter:
        type: pigpio_adapter.PiGPIOAdapter

    config_schema:
      !vol/Required {schema: pin_r, default: 22}:
        !vol/All
          - !vol/Coerce { type: !type/int }
          - !vol/Range { min: 2, max: 40 }

      !vol/Required {schema: pin_g, default: 27}:
        !vol/All
          - !vol/Coerce { type: !type/int }
          - !vol/Range { min: 2, max: 40 }

      !vol/Required {schema: pin_b, default: 17}:
        !vol/All
          - !vol/Coerce { type: !type/int }
          - !vol/Range { min: 2, max: 40 }

      !vol/Required {schema: pigpio_adapter}:
        !type/str

    state:
      mode:
        setter: set_mode
        default: static
      color:
        setter: set_color
        type: Color
        default: [50, 0, 0]
      "on":
        setter: set_on
        default: False

    actions:
      toggle: toggle_on